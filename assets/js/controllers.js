canIWalk.controller('walkController', ['$http', '$scope', function($http, $scope) {

  $scope.message = "we are talking to Angular!";
  console.log('control!');

  // $http.get('https://obscure-lowlands-76683.herokuapp.com/').success(function(data){
  //
  //   console.log("we are talking to the rails json!");
  //   console.log(data);
  //   $scope.stuff = data;
  // });

  $scope.clickMe = function (){

};

}]);

canIWalk.controller('gMapController', ['$scope', 'mapFactory', function(NgMap, $scope, mapFactory) {
  // NgMap.getMap().then(function(map) { //this isn't needed to display the map. Whyyyyy?
    console.log('canIwalk Controller working')
    findTrip();
  // });
}]);
//end gMapController. This controller runs the map making function in walk-info page


canIWalk.controller('destinationController', ['$scope', 'mapFactory', function($scope, mapFactory) {
  // console.log("we are in the destination Controller");
  var vm = this;
  // vm.types = "['establishment']";
  vm.placeChanged = function() {
    vm.place = this.getPlace();
    $scope.destLat = vm.place.geometry.access_points[0].location.lat;
    $scope.destLng = vm.place.geometry.access_points[0].location.lng;
    $scope.destName = vm.place.name;
   //  $scope.tripData.destLat = $scope.destLat;
   //  $scope.tripData.destLng = $scope.destLng;
   //  $scope.tripData.destName = $scope.destName;
    console.log('destCtrl working '+$scope.destLat);
    $scope.test = function(){
      console.log(mapFactory.$scope.tripData.check);
   }
}

}]);
// end destCtrl. This controller is what does the autocomplete on input destination.

canIWalk.factory('mapFactory', function($scope){
   console.log('factory');

  var tripData = {};       //our object. will have things passed into it soon

  tripData.check=function(){
     console.log('check factory');
 }
  // var destLat = '';        //variables we're declaring. We want to be able to decide what to do with them, so we're not putting them into the object just yet.
  // var destLng = 'check factory is wired';
  // var destName = '';
  //
  // var distance = '';
  // var duration = '';
  //
  // console.log("scope lat " + $scope.destLat + " scope lng " + $scope.destLng + "scope destname "+$scope.destName);
  // //this is (hopefully) taking the destination variables generated by the destCntrl and putting them into the tripdata object
  // $scope.destLat = vm.place.geometry.access_points[0].location.lat;
  // $scope.destLng = vm.place.geometry.access_points[0].location.lng;
  // $scope.destName = vm.place.name;
  // tripData.destLat = $scope.destLat;
  // tripData.destLng = $scope.destLng;
  // tripData.destName = $scope.destName;
  // return tripData;
  // console.log('factory')
});
//factory for holding information about the destination, so that it'll pass through into the gMapController

canIWalk.controller('registrationController', ['$scope', '$http', function($scope) {
  console.log("we are in the registration Controller");

  $scope.register = function() {
    if ($scope.username && $scope.email && $scope.password) { // check if the fields have been populated

    // here is a standard jquery ajax call
      // $.ajax({
      //         type : 'POST',
      //         dataType : 'json',
      //         url: 'http://peaceful-journey-51869.herokuapp.com/users/?user[name]='+this.username+'&user[email]='+this.email+'&user[password]='+this.password,
      //         headers: {
      //             contentType: "application/json",
      //           },
      //         success : function(data) {
      //             console.log("posting registration data to the DB was successful");
      //
      //         }, error: function(request,error){
      //             console.log("this item has already been deleted from cartEvents");
      //         }
      // });
      //


    // and here is a native angular call
    // $http({
    //   method: 'POST',
    //   url: 'http://peaceful-journey-51869.herokuapp.com/users/?user[name]='+this.username+'&user[email]='+this.email+'&user[password]='+this.password
    // }).then(function successCallback(response) {
    // // this callback will be called asynchronously
    // // when the response is available
    // console.log("successful POST");
    // console.log(response);
    // }, function errorCallback(response) {
    // // called asynchronously if an error occurs
    // // or server returns response with an error status.
    // console.log("unsuccessful POST");
    // console.log(response);
    // });

    // http://peaceful-journey-51869.herokuapp.com/users/?user[name]=mason&user[email]=mason@mail.com&user[password]=password

      console.log(this.username + this.email + this.password);
      $scope.username = '';
      $scope.email = '';
      $scope.password = '';
    } else { // if some registration fields are empty...
      alert("One or more registration fields is empty.");
    }
  };


}]);
